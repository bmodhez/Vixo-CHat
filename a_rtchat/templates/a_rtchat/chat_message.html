{% if message.body and message.body|slice:":6" == "[CALL]" %}
    <div data-message-id="{{ message.id }}" class="flex justify-center mb-2{% if extra_classes %} {{ extra_classes }}{% endif %}">
        <div class="max-w-[90%]">
            <div class="inline-flex items-center gap-2 rounded-full border border-gray-800 bg-gray-900/70 px-4 py-2 text-xs text-gray-200">
                <span>{{ message.body|cut:"[CALL] " }}</span>
                <span class="text-gray-500">â€¢</span>
                <span class="text-gray-400">{{ message.created|timesince }} ago</span>
            </div>
        </div>
    </div>
{% else %}
<div data-message-id="{{ message.id }}" class="flex {% if message.author == user %}justify-end{% else %}justify-start{% endif %} mb-2{% if extra_classes %} {{ extra_classes }}{% endif %}">
    <div class="flex flex-col {% if message.author == user %}items-end{% else %}items-start{% endif %} max-w-[80%]">
        
        <div class="flex items-center gap-2 mb-1 px-1">
            {% if message.author != user %}
                <img src="{{ message.author.profile.avatar }}" class="w-5 h-5 rounded-full object-cover">
                <span class="text-[10px] font-bold text-gray-500 uppercase">{{ message.author.profile.name }}</span>
            {% endif %}
        </div>

        <div class="px-4 py-2.5 rounded-2xl shadow-sm 
            {% if message.author == user %}
                bg-indigo-600 text-white rounded-tr-none
            {% else %}
                bg-white text-gray-800 border border-gray-100 rounded-tl-none
            {% endif %}">
            <div class="text-sm leading-relaxed">{% include 'a_rtchat/partials/message_content.html' %}</div>
        </div>
        
        <span class="text-[9px] text-gray-400 mt-1 px-1">{{ message.created|date:"H:i" }}</span>
    </div>
</div>
{% endif %}